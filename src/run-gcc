#!/usr/bin/env bash
# Compile and run C/C++ programs

set -euo pipefail

# Ensure a file is provided as an argument
FILE="${1:?'Error: Please specify a C/C++ file'}"
FILENAME="${FILE##*/}"
OUTPUT="${FILENAME%.*}.out"

# Determine compiler based on file extension
case "${FILE##*.}" in
c) COMPILER="gcc" ;;
cpp | cc | cxx) COMPILER="g++" ;;
*)
  echo "Error: Unsupported file type '${FILE##*.}'"
  exit 1
  ;;
esac

# Check if the file exists
if [[ ! -f "$FILE" ]]; then
  echo "Error: File '$FILE' does not exist"
  exit 1
fi

# Compile the file
"$COMPILER" -Wall -Wextra -o "$OUTPUT" "$FILE"

# Run the compiled program
./"$OUTPUT"

# Clean up the generated output file
rm -f "$OUTPUT"
